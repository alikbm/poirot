%div.activity(ng-app="poirot" ng-controller="ActivityController")
  %header
    %a.parent(ng-if="mainActivity.parent_id && mainActivity.parent_id != 'undefined'" ng-click="openActivity(mainActivity.parent_id)")
    %a.activity-button.sprite.metadata(ng-click="toggleMetadata()")
    %b
      Activity
      {{mainActivity.id}}
    %span.activity-title
      {{mainActivity.description || "(no description)"}}

  %section.metadata-visible(ng-class="{'metadata-visible' : metadataVisible}")
    .metadata-view
      .metadata-item(ng-repeat="(key, value) in metadataActivity.fields")
        .metadata-key {{key}}
        .metadata-value {{value}}

    .details
      %table.heading.table
        %colgroup
          %col.flow
          %col.gutter
          %col
          %col.timestamp
        %thead
          %tr
            %th
            %th
            %th Message
            %th Time

      .grid-viewport
        .message-tooltip.level-icon(ng-show="tooltip.visible" ng-style="tooltip.style" class="{{tooltip.cssClass}}")
          {{tooltip.message}}
        %table
          %tr
            %td.explorer.flow
              %svg#flow-viewer
            %td
              %table.table.table-striped.table-hover.log-entries
                %colgroup
                  %col.gutter
                  %col
                  %col.timestamp
                %tbody
                  %tr(ng-repeat="entry in entries" ng-click="selectEntry($index)")
                    %td(class="gutter {{entry.selected ? 'selected' : ''}}")<
                      %span.gutter(style="background-color: {{entry.activityColor}}")<
                      %span(ng-if="entry.selected" class="arrow" style="border-right-color: {{entry.activityColor}}")<>
                    %td(class="level-icon {{entry.cssClass}}" ng-mouseenter="showTooltip(entry, $event)" ng-mouseout="hideTooltip()")
                      {{entry.message}}
                    %td {{formatTimestamp(entry.timestamp)}}

